{% load get_record_value_by_field %}

{% for model in models %}
    <div id="record-list-{{ model.model_name }}">
        <h3>{{ model.model_name }}</h3>
        <table class="table-collapse">
            <thead>
            <tr onclick="toggleHeaderSelection(event)">
                <th></th>
                {% for field_name in model.field_names %}
                    <th data-rec-field-name="{{ field_name }}">{{ field_name|capfirst }}</th>
                {% endfor %}
            </tr>
            </thead>
            <tbody>
            {% for rec in model.records %}
                <tr class="selectable" data-rec-model="{{ model.model_name }}" data-rec-id="{{ rec.id }}">
                    {#                    Todo: add support for selecting and adding rows to context#}
                    <td><input type="checkbox" onchange="toggleSelection(event)"></td>
                    {% for field_name in model.field_names %}
                        <td class="selectable" data-cell-value="{{ rec|get_record_value_by_field:field_name }}"
                            data-rec-field-name="{{ field_name }}" data-rec-id="{{ rec.id }}"
                            data-rec-model="{{ model.model_name }}" onclick="toggleSelection(event)"
                            draggable="true">
                            <span>{{ rec|get_record_value_by_field:field_name }}</span>
                            {#                            <button onclick="addTo(event)">Add</button>#}
                        </td>
                    {% endfor %}
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

{% endfor %}